#include <stdio.h>
#include <stdlib.h>
#define BLK "\e[0;30m"
#define RED "\e[0;31m"
#define GRN "\e[0;32m"
#define YEL "\e[0;33m"
#define BLU "\e[0;34m"
#define MAG "\e[0;35m"
#define CYN "\e[0;36m"
#define WHT "\e[0;37m"

int main(void) {
  float preco, armaz = 0, vend = 0, i;
  // i=para armazenar quantos litros serão abastecidos em um carro
  int fila, carro = 0, flag, flag2, flag3, atend = 0;
  // flags = escolhas para menus

  printf("Programa por: João Otávio Bazzo Zimermann\n");
  printf("Este programa foi criado com o proposito de gerenciar um posto de "
         "gasolina\nhipotetico\n\n");

  printf("Informe o valor do combustivel:\n");
  scanf("%f", &preco);
  printf("Informe o tamanho da fila suportada:\n");
  scanf("%d", &fila);
  printf("Informe a quantidade de combustivel armazenado:\n");
  scanf("%f", &armaz);

  while (flag != 5) {
    printf("\e[1;1H\e[2J");
    // system("clear");
    printf(WHT
           "\nSelecione a opção:\n1. Adicionar carro a fila\n2. Abastecer\n3. "
           "Exibir fila de espera\n4. Relatórios\n5. Encerrar\n");
    scanf("%d", &flag);
    printf("\n");

    switch (flag) {
    case 1:
      if (carro < fila) {
        ++carro;
        printf(GRN "Carro adicionado\n");
      } else {
        printf(RED "A fila está em capacidade máxima\n");
      }
      break;
    case 2:
      if (carro > 0) {
        printf(WHT "Informe quantos litros serão abastecidos:\n");
        scanf("%f", &i);
        if (armaz <= 0) {
          printf("Não há mais combustivel, carros serão liberados");
          carro = 0;
        } else if (i > armaz) {
          printf("Quantidade excede ao que resta nas reservas, abastecer com o "
                 "restante: %.3f litros?\n" GRN "1.Sim\n" RED "2.Não\n" WHT,
                 armaz);
          scanf("%d", &flag3);
          switch (flag3) {
          case 1:
            i = armaz;
            armaz = 0;
            vend = vend + i;
            ++atend;
            printf(GRN "Carro abastecido\n");
            break;
          case 2:
            printf(RED "Carro não foi abastecido\n");
            break;
          default:
            printf("Operação cancelada, instrução inválida");
          }
        } else {
          --carro;
          printf(GRN "Carro abastecido\n");
          ++atend;
          armaz = armaz - i;
          vend = vend + i;
        }
      } else {
        printf(YEL "Não há carros para abastecer\n");
      }
      break;
    case 3:
      printf("A quantidade de carros na fila é de: %d\n", carro);
      break;
    case 4:
      while (flag2 != 6) {
        printf("\e[1;1H\e[2J");
        printf(
            WHT
            "\nInforme a opção:\n1. Quantidade de litros vendida\n2. Valor "
            "arrecadado\n3. Quantidade "
            "de carros abastecidos\n4. Quantidade de combustivel restante\n5. "
            "Gerar arquivo para impressão\n6. Voltar ao menu anterior\n");
        scanf("%d", &flag2);
        printf("\n");
        switch (flag2) {
        case 1:
          printf("%.2f litros foram vendidos\n", vend);
          break;
        case 2:
          printf("R$%.2f foram arrecadados\n", vend * preco);
          break;
        case 3:
          printf("%d carros foram abastecidos\n", atend);
          break;
        case 4:
          printf("%.2f de combustivel restam no tanque\n", armaz);
          break;
        case 5:
          printf("Arquivo sendo gerado...\n");
          break;
        case 6:
          printf(YEL "Voltando...\n");
          break;
        default:
          printf(RED "Opção inválida\n");
          break;
        }
        printf(WHT "\nPressione qualquer tecla para continuar:");
        getchar();
        getchar();
      }
      break;
    case 5:
      printf(YEL "Encerrando...");
      exit(0);
      break;
    default:
      printf(RED "Intrução inválida\n");
      break;
    }
    printf(WHT "\nPressione qualquer tecla para continuar:");
    getchar();
    getchar();
  }

  return 0;
}
